<div class="painel-container">
  <div class="header">
    <h2>Painel de Pedidos (Cozinha)</h2>
    <button (click)="carregarPedidos()" class="btn btn-atualizar">
      â†» Atualizar
    </button>
  </div>

  @if (loading()) {
    <p class="loading">Carregando pedidos...</p>
  }

  <div class="grid-pedidos">
    @for (pedido of pedidos(); track pedido.id) {
      <div class="card" [ngClass]="getStatusClass(pedido.statusPedido)">
        
        <div class="card-header">
          <span class="pedido-id">#{{ pedido.numero || pedido.id.substring(0, 4) }}</span> 
          <span class="badge-status">{{ getNomeStatus(pedido.statusPedido) }}</span>
        </div>

        <div class="card-body">
          <p><strong>Cliente:</strong> {{ pedido.nomeCliente || 'Cliente' }}</p>
          <p><strong>Total:</strong> {{ pedido.valorTotal | currency:'BRL' }}</p>
          <p class="data">{{ pedido.dataPedido | date:'HH:mm - dd/MM' }}</p>
          
          <div class="itens-lista">
            @for (item of pedido.itens; track $index) {
              <div class="item-row">
                <span class="qtd">{{ item.quantidade }}x</span> 
                <span class="prod">{{ item.nome }}</span>
              </div>
            }
          </div>
        </div>

        <div class="actions">
           @if (pedido.statusPedido === 1 || pedido.statusPedido === 2) {
             <button (click)="avancarStatus(pedido)" class="btn btn-preparo">
               ðŸ”¥ Iniciar Preparo
             </button>
           }
           
           @if (pedido.statusPedido === 3) {
             <button (click)="avancarStatus(pedido)" class="btn btn-moto">
               ðŸ›µ Despachar Entrega
             </button>
           }

           @if (pedido.statusPedido === 4) {
             <button (click)="avancarStatus(pedido)" class="btn btn-check">
               âœ… Confirmar Entrega
             </button>
           }
        </div>
      </div>
    } @empty {
      @if (!loading()) {
        <div class="empty-state">
          <p>Nenhum pedido na fila.</p>
        </div>
      }
    }
  </div>
</div>